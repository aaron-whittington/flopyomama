var TOTAL_STARTING_COMBINATIONS=1326;
$(document).ready(function(){nsFilter.nsHtml.fReBuildFilterMenu();var b=nsUtil.fGetLocalStorage("filter_settings");null!=b&&""!=b&&(nsUI.fToggleCheckableMenu($("#"+b),!0),nsUtil.fLog("toggle: "+b));$("#dev_menu .theme_select li").click(function(){var a=$(this).children("a").first().attr("href").substring(1),b="style/flopyomama.css",c="lib/bootstrap/dist/css/bootstrap.min.css";"default_theme"!=a&&(b="style/themes/"+a+"/flopyomama.css",c="style/themes/"+a+"/bootstrap.min.css");nsUtil.fLog(b);nsUtil.fLog(c);
$("link.btstrap").attr("href",c);$("link.main").attr("href",b);nsUI.fEvaluateKnownCards()});nsUI.fRestoreBoard();nsHtml.fRestoreStatHtml();$("#results_go").click(function(){nsRange.fGetAllUnknownCombinationsThreaded()});$("#results_progress").bind("done",function(){$(this).removeClass("active");$(this).children("div").addClass("progress-bar-success").css("width","100%")});$("#results_progress").bind("start",function(){$(this).addClass("active");$(this).children("div").removeClass("progress-bar-success").css("width",
"0%")});$("#win_percent_bar div").popover({content:function(){var a="",a=$(this).hasClass("progress-bar-success")?a+"Hero wins: ":$(this).hasClass("progress-bar-danger")?a+"Hero loses: ":a+"Hero draws: ",b=$(this)[0].style.width;return a+=parseFloat(b).toFixed(2)+"%"},container:"body",placement:"auto bottom",trigger:"hover",html:!0});$("#win_percent_bar").bind("start",function(){nsUI.fDeleteLongStatistics()});$("#fixed_ranges li").popover({content:function(){return'<span class="btn"> <abbr title="Under the Gun">UTG</abbr></span> <span class="btn">EP</span><span class="btn">MP</span><span class="btn">LP</span> <span class="btn">CO</span><span class="btn">SB</span> <span class="btn">BB</span>'},
container:"body",placement:"auto right",html:!0});$("body").click(function(a){$(a.target).parents().addBack().is("#op_range")});$("#clear_selection").click(function(){$("#op_range td").removeClass("custom");$("#range_slider").slider("value",$("#range_slider").slider("value"))});var c=!1,e=!1,d=!1,g=$("#results_col").attr("class");$(window).resize(function(a){if(1008>=innerWidth)c||(a=$("#results_col").detach(),a.removeClass().addClass("row").appendTo("#content"),c=!0);else if(c)a=$("#results_col").detach(),
a.removeClass().addClass(g).appendTo("#range_row"),c=!1;else return;784>=innerWidth?(e||(a=$("#rand_buttons").detach(),a.appendTo("#my_cards"),e=!0),d||(a=$("#range_col").detach(),a.appendTo("#content"),d=!0)):(e&&(a=$("#rand_buttons").detach(),a.appendTo("#board"),e=!1),d&&(a=$("#range_col").detach(),a.prependTo("#range_row"),d=!1))});$(window).triggerHandler("resize");$("body").on("click",".expanded_pair .pair_string",function(){$(this).toggleClass("selected");var a=$(this).parent(),b=a.attr("id").split("_")[2],
c=a.children().length,a=a.children(".selected").length,b=$("#op_range_"+b),d=b.find(".static_bg");d.find(".glyphicon-cog").remove();0<a?(b.addClass("selected"),c!=a&&d.append('<span class="glyphicon glyphicon-cog"></span>')):b.removeClass("selected")});$("#range_scales li").click(function(){if(bActivated=nsUI.fToggleCheckableMenu(this,!0)){var a=$(this).attr("id");nsUtil.fSetLocalStorage("range_type",a);"sklansky"==a?fRangeFunction=fGetSlanskyFromPercent:"statistical"==a&&(fRangeFunction=fGetStatisticalFromPercent)}});
b=nsUtil.fGetLocalStorage("range_type");null==b&&(b="statistical");"undefined"==typeof fRangeFunction&&(fRangeFunction=fGetSlanskyFromPercent);$("#"+b).triggerHandler("click");$("#range_slider").append('<div class="range_slider_bg">&nbsp;</div>');$("[title]").tooltip({container:"body"});$("#known_cards").popover({content:function(){return nsHtml.fGetBoardSelectionTable()},container:"#known_cards",placement:"auto bottom",trigger:"manual",html:!0});$("#known_cards").click(function(a){$(a.target).parents().addBack().is($("#rand, #rand_ctrl, #randomMenu"))||
$("#board_selection_table").is(":visible")||$("#known_cards").popover("show")});$("body").on("click","#board_selection_table .glyphicon-remove",function(a){$("#known_cards").popover("hide")});$("body").on("click","#board_selection_table .card",function(a){if($(this).is(".selected"))nsUI.fSelectKnown($(this).html()),nsUI.fDeleteBoard($(this).html()),$(this).removeClass("disabled selected");else{var b=nsUI.fSetBoardCard($(this).html());b!==EMPTY_CARD_STRING&&$("#board_selection_table .card").each(function(){$(this).html()===
b&&$(this).removeClass("disabled selected")});$(this).addClass("disabled selected");nsUI.fSelectNext(!0)}nsUI.fAfterBoardChange()});nsUI.fSelectKnown(0,0);$(".known.btn").click(function(){nsUI.fSelectKnown($(this).attr("id").split("_")[1]-1,0)});$(document).bind("keydown",function(a){nsUI.fHandleKeyPress(a.keyCode?a.keyCode:a.which,a)});$("#filter_config_menu").on("click","li:not(#new_edit_filter)",function(a){a.preventDefault();nsUI.fToggleCheckableMenu(this,!0);$(this).hasClass("active")?(nsUtil.fSetLocalStorage("filter_settings",
$(this).attr("id")),a="Filter "+$(this).find("a").html(),a=a.substring(0,a.indexOf("<")),$("#filter_config").attr("title",a)):($("#filter_config").attr("title","Filter"),nsUtil.fSetLocalStorage("filter_settings",""));nsUI.fEvaluateKnownCards()});$("#rand").click(function(){var a=fGetRandomCards(7);$("#random_hand").hasClass("active")&&(nsUI.fDeleteBoard(0),nsUI.fDeleteBoard(1),nsUI.fSelectKnown(0),nsUI.fSetBoardCard(a.slice(0,2)));$("#random_flop").hasClass("active")&&(nsUI.fDeleteBoard(2),nsUI.fDeleteBoard(3),
nsUI.fDeleteBoard(4),nsUI.fSelectKnown(2),nsUI.fSetBoardCard(a.slice(2,5)));$("#random_turn").hasClass("active")&&(nsUI.fDeleteBoard(5),nsUI.fSelectKnown(5),nsUI.fSetBoardCard(a.slice(5,6)));$("#random_river").hasClass("active")&&(nsUI.fDeleteBoard(6),nsUI.fSelectKnown(6),nsUI.fSetBoardCard(a.slice(6,7)));nsUI.fAfterBoardChange()});$("#randomMenu li").not("#clear_board").click(function(a){a.stopPropagation();nsUI.fToggleCheckableMenu(this);var b=[];$("#randomMenu li.active").each(function(){b.push("#"+
$(this).attr("id"))});nsUtil.fSetLocalStorage("random_settings",b)});var b=nsUtil.fGetLocalStorage("random_settings"),f="",f=null==b?"#random_hand, #random_flop":b.join(", ");nsUI.fToggleCheckableMenu($(f));$("#clear_board").click(function(a){a.stopPropagation();nsUI.fDeleteBoard()})});
$(document).ready(function(){$("#content").removeClass("preload");$("#filter_editor").bind("hide.bs.modal",function(){if(nsFilter.nsHtml.fUpdateUI())return confirm("You have unsaved changes. Do you wish to discard them?")?!0:!1});$("#discard_filter").click(function(){confirm("Discard changes?")&&(nsFilter.sEditedJSON=nsFilter.sOriginalJSON,nsFilter.nsHtml.fLoadFilterFromObject(nsFilter.sOriginalJSON),nsFilter.nsHtml.fUpdateUI())});$("#delete_filter").click(function(){});$("#save_filter").click(function(){nsFilter.fSaveFilter();
nsFilter.nsHtml.fReBuildFilterMenu();nsFilter.sEditedJSON=nsFilter.sOriginalJSON;nsFilter.nsHtml.fUpdateUI()});$("#filter_editor").on("click",".new_subfilter",function(){var b=$(this).parents(".filter_ctrl_row");nsFilter.nsHtml.fAddSubRow(b);nsFilter.fSetEditedJson();nsFilter.nsHtml.fUpdateUI()});$("#filter_editor").on("click",".delete_subfilter",function(){var b=$(this).parents(".filter_ctrl_row"),c=b.next();b.next().is(".filter_group_subgroup")?0<b.next().children().length&&confirm("Deleting a group requires deleting all sub-elements! Continue?")&&
(c.remove(),b.remove()):b.remove();nsFilter.fSetEditedJson();nsFilter.nsHtml.fUpdateUI()});$("#filter_editor").on("click","#filter_loaded .dropdown-menu li",function(){var b=$(this).parent().parent().prev(),c=!1,e=$(this).parent().parent().parent().parent(),d=$(this).parents(".filter_ctrl_row");0<$(this).parents(".filter_group_subgroup").length&&(c=!0);var g=$(this).find("a").html(),f=$(this).find("a").attr("class"),a=$(this).hasClass("selected");$(this).addClass("selected active").siblings().removeClass("selected active");
a||($(this).parent().is(".sub_filter_type")?(b=nsFilter.nsHtml.fSubFilterButtonGroup(f,c),d.next().is(".filter_group_subgroup")?0<d.next().children().length&&confirm("Changing this group type will delete sub-elements! Continue?")&&(d.next().remove(),e.html(b)):e.html(b)):b.html(g),nsFilter.fSetEditedJson(),nsFilter.nsHtml.fUpdateUI())});$("body").on("show.bs.modal","#filter_editor",function(){nsFilter.nsHtml.fLoadNew();setTimeout(function(){nsUI.fAddEventsToCombobox("sel_filter");$("#sel_filter").keypress(function(){nsFilter.nsHtml.fUpdateUI()});
nsFilter.sEditedJSON="";nsFilter.sOriginalJSON="";nsFilter.nsHtml.fUpdateUI();$("#sel_filter").bind("validated",function(){if(nsFilter.sOriginalJSON==nsFilter.sEditedJSON){$("#filter_loaded").remove();var b;b=$("#sel_filter li.active").attr("id");b=isNot(b)?"":b.substring(4);sInnerHtml=nsFilter.nsHtml.fFilterHtmlFromSelect(b);$("#filter_editor .modal-body").append(sInnerHtml);b=nsFilter.fCurrentToJSON();nsFilter.sEditedJSON=b;nsFilter.sOriginalJSON=b}})},1)})});
var FlopYoMama=AWModel.extend({initialize:function(){this.router=new TableRouter;Backbone.history.start({pushState:!1,root:"/dev/flopyomama.html"});this.slider=new Silder;this.sliderView=new SliderView({model:this.slider,el:$("#range_slider")[0]});this.sliderView.trigger("update");this.rangeTable=new RangeTable;this.rangeTable.listenToSlider(this.slider);this.rangeTableView=new RangeTableView({model:this.rangeTable});this.listenTo(this.rangeTable,"finalize",this.finalizeHandler)},finalizeHandler:function(b){nsUtil.fLog("Main Ap Finalize");
nsUI.fEvaluateKnownCards()}});$(function(){window.flopYoMama=new FlopYoMama});
