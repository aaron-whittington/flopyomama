var nsWorkerTextures={};
self.addEventListener("message",function(a){a=a.data;switch(a.cmd){case "start":a.bMin?importScripts("lib.min.js"):importScripts("../lib/underscore/underscore-min.js","Maths.js","Hand.js","DrawingHand.js","Convert.js","Filter.js","Util.js");try{fPostConsole("STARTING TEXTURE WORKER"),nsWorkerTextures.fCalculateBoards(a.aoStartingHands,a.aKnownCards,a.aFixedBoardCards,a.oFilter)}catch(c){fPostConsole("ERROR"+c.toString())}break;case "stop":self.close();break;default:self.postMessage("Unknown command: "+a.msg)}},
!1);
nsWorkerTextures.fCalculateBoards=function(a,c,d,k){(new Date).getTime();var m=0,n={},p={},l=[];fPostConsole("TEST TEST TEST");for(var e=a.length-1;0<=e;e--){var f=a[e].sPair;l[f]=[];for(var g=fFilterCardPairArray(a[e].aPair,c),q=g.length,h=0;h<g.length;h++){var b=[],b=g[h].concat(d);if(isNot(k))b=nsDrawingHand.fGetDrawingHands(b);else{if(!nsFilter.nsEvaluate.fEvaluateFilter(k,b)){l[f].push(g[h]);continue}b=nsFilter.nsEvaluate.oCurrentHand}b=nsDrawingHand.fHandToString(b).split("-");for(j=0;j<b.length;j++)b[j]=
b[j].trim(),nsWorkerTextures.fAddToRecordDic(n,b[j],f),m++}p[f]=q}self.fPostDone({oVillainStat:n,count:m,oPairLengthDic:p,oFilterRecord:l})};nsWorkerTextures.fAddToRecordDic=function(a,c,d,k){"undefined"==typeof a[c]&&(a[c]={oPairRecord:{},count:0});"undefined"==typeof a[c].oPairRecord[d]?a[c].oPairRecord[d]=1:a[c].oPairRecord[d]++;a[c].count++};
var fPostConsole=function(a){self.postMessage({type:"console",msg:a})},fPostDone=function(a){self.postMessage({type:"done",msg:a});self.close()},fPostProgress=function(a){self.postMessage({type:"progress",msg:a})};
